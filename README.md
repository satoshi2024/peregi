CURSOR CELTAXSHINKOKU (P_NMIN NUMBER, P_NMAX NUMBER) IS
  SELECT *
  FROM (
    SELECT t.*,
           ROW_NUMBER() OVER (
             PARTITION BY t.KOJIN_NO
             ORDER BY t.RENBAN DESC       -- 取该KOJIN_NO的最大连番
           ) AS rn
    FROM ZABWSHINKOKU_ELTAXCSV t
    WHERE t.NENBUN = GJOKEN.INENDO
  )
  WHERE rn = 1
    AND RENBAN BETWEEN P_NMIN AND P_NMAX
  ORDER BY RENBAN;